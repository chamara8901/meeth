# 1. [管理画面再構築](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-%E7%94%BB%E9%9D%A2%E4%B8%80%E8%A6%A7%28ver2.0%29) - M8.1:お知らせ追加 機能設計書

- [1. 管理画面再構築 - M8.1:お知らせ追加 機能設計書](#1-管理画面再構築---m81お知らせ追加-機能設計書)
  - [1.1. 処理概要](#11-処理概要)
    - [1.1.1. 機能名](#111-機能名)
    - [1.1.2. 機能概要](#112-機能概要)
    - [1.1.3. 前提条件](#113-前提条件)
    - [1.1.4. 処理概要](#114-処理概要)
    - [1.1.5. パラメータ一覧](#115-パラメータ一覧)
    - [1.1.6. テーブル一覧](#116-テーブル一覧)
    - [1.1.7. ファイル一覧](#117-ファイル一覧)
  - [1.2. レイアウト](#12-レイアウト)
    - [1.2.1. 画面イメージ（現行）](#121-画面イメージ現行)
    - [1.2.2. 画面イメージ（再構築）](#122-画面イメージ再構築)
    - [1.2.3. 画面項目](#123-画面項目)
    - [1.2.4. イベント定義](#124-イベント定義)
  - [1.3. API](#13-api)
    - [1.3.1. API一覧](#131-api一覧)

## 1.1. 処理概要

### 1.1.1. 機能名

|  No.  |       項目       |         値          |
| :---: | :--------------: | :-----------------: |
|   1   |   プロジェクト   | meeth様ECサイト開発 |
|   2   |     システム     |      管理画面       |
|   3   |  画面プログラム  |    お知らせ追加     |
|   4   | 画面プログラムID |        M8.1         |
|   5   |  画面フォーム名  |         N/A         |

### 1.1.2. 機能概要

- お知らせの新規作成を行う
  - タイトル, お知らせ本文, お知らせ枠設定
    - ボタンによるリンク生成が可能
- お知らせ履歴を表示する
- お知らせ編集画面へ遷移する

### 1.1.3. 前提条件

- ログイン済のユーザであること
- ログインユーザの[権限](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-%E6%A8%A9%E9%99%90%E4%B8%80%E8%A6%A7)が条件を満たしていること(総合管理者、許可された作業担当者のみ閲覧・操作可能)

### 1.1.4. 処理概要

| No  | 操作                   | 処理概要                                                                                               |
| --- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 1   | 初期表示時             | お知らせ追加フォームが表示される                                                                       |
| 2   | リンク挿入ボタンを押下 | お知らせ本文にリンク(<a>タグ)が生成される                                                              |
| 3   | 追加ボタンを押下       | 確認アラートが表示され、お知らせが追加される<br>成功またはエラー内容を記載する旨のフラッシュを表示する |
| 4   | 編集リンクを押下       | お知らせ編集画面へ遷移する                                                                             |

### 1.1.5. パラメータ一覧

なし

### 1.1.6. テーブル一覧

| No  | 論理名称                                                                                                                | 物理名称 | I/O | 備考 |
| --- | ----------------------------------------------------------------------------------------------------------------------- | -------- | --- | ---- |
| 1   | [お知らせテーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_topics) | topics   | O   |      |

### 1.1.7. ファイル一覧

なし

## 1.2. レイアウト

### 1.2.1. 画面イメージ（現行）

![image](https://user-images.githubusercontent.com/77314669/114654879-0994d900-9d26-11eb-842d-6fda503496df.png)


### 1.2.2. 画面イメージ（再構築）

![image](https://user-images.githubusercontent.com/24938069/118101244-57c6f600-b412-11eb-87c0-1666533fafb7.png)

&dArr;
![image](https://user-images.githubusercontent.com/24938069/118101372-80e78680-b412-11eb-9448-cacbc2f8a471.png)

&dArr;
![image](https://user-images.githubusercontent.com/24938069/118101462-9d83be80-b412-11eb-8842-87ad580653e8.png)


### 1.2.3. 画面項目

| No  | 名称               | 対応DB項目                            | I/O | 種別             | 型     | 桁数 | 必須(YES/NO) | バリデーション | 備考                                                                            |
| --- | ------------------ | ------------------------------------- | --- | ---------------- | ------ | ---- | ------------ | -------------- | ------------------------------------------------------------------------------- |
| 1   | 新規追加           | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
| 2   | タイトル           | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
|     |                    | topics.title                          | I   | テキストフォーム | string | 255  | YES          | 必須、桁数制限 |                                                                                 |
| 3   | お知らせ本文       | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
|     |                    | topics.note                           | I   | テキストエリア   | text   | ー   | YES          | 必須           | WYSIWYGエディターによる操作を可能とする                                         |
| 4   | リンク挿入         | ー                                    | O   | ボタン           | ー     | ー   | ー           | ー             | 押下時にお知らせ本文にaタグを挿入                                               |
| 5   | リンクラベル       | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
|     |                    | ー                                    | I   | テキストフォーム | string | ー   | NO           | ー             | リンク挿入ボタン押下時に、aタグのラベルとして挿入される                         |
| 6   | リンク先URL        | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
|     |                    | ー                                    | I   | テキストフォーム | string | ー   | NO           | ー             | リンク挿入ボタン押下時に、aタグのリンクとして挿入される                         |
| 7   | 別ウィンドウで開く | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
|     |                    | ー                                    | I   | チェックボックス | ー     | ー   | NO           | ー             | リンク挿入ボタン押下時に、aタグにtarget = blankが挿入される                     |
| 8   | トップお知らせ枠   | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
|     |                    |                                       | I   | ラジオボタン     | ー     | ー   | ー           | ー             | 【表示しない, お知らせ枠（１）に表示, お知らせ枠（２）に表示】                  |
| 9   | 追加               | ー                                    | O   | ボタン           | ー     | ー   | ー           | ー             |                                                                                 |
| 10  | 掲載中のお知らせ   | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
| 11  | 総件数             | ー                                    | O   | テキスト         | ー     | ー   | ー           | ー             |                                                                                 |
| 12  | 掲載日             | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
|     |                    | topics.published_at                   | O   | テキスト         | ー     | ー   | ー           | ー             |                                                                                 |
| 13  | 掲載ステータス     | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
|     |                    | topics.status                         | O   | テキスト         | ー     | ー   | ー           | ー             | ステータス文言の前に、公開中なら緑色の、それ以外ならグレーのアイコンを表示する |
| 14  | お知らせ           | ー                                    | O   | ラベル           | ー     | ー   | ー           | ー             |                                                                                 |
|     |                    | topics.display_option<br>topics.title | O   | テキスト         | ー     | ー   | ー           | ー             |                                                                                 |
| 15  | 編集               | ー                                    | O   | ボタン           | ー     | ー   | ー           | ー             |                                                                                 |
| 16  | 確認アラート       | ー                                    | O   | アラート         | ー     | ー   | ー           | ー             |                                                                                 |
| 17  | 結果フラッシュ     | ー                                    | O   | リンク           | ー     | ー   | ー           | ー             |                                                                                 |
| 18  | プレビュー         | ー                                    | O   | フラッシュ       | ー     | ー   | ー           | ー             | 入力値でのユーザー画面プレビューを表示                                          |

### 1.2.4. イベント定義

| No  | 項目       | 発生条件 | 遷移先                                                                                                                                                                                              | 備考                 | API                     |
| --- | ---------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------- | ----------------------- |
| 1   | 初期表示   | ー       | ー                                                                                                                                                                                                  | ー                   | お知らせ履歴情報取得API |
| 2   | 追加ボタン | クリック |                                                                                                                                                                                                     | 確認アラート表示の上 | お知らせ新規追加API     |
| 2   | 編集リンク | クリック | [お知らせ編集画面](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-0082.M8.2%3A%E3%81%8A%E7%9F%A5%E3%82%89%E3%81%9B%E7%B7%A8%E9%9B%86_ver2.0) |                      |                         |

## 1.3. API

### 1.3.1. API一覧

| NO. | 名称                    | 内容                                                                  |
| --- | ----------------------- | --------------------------------------------------------------------- |
| 1   | お知らせ新規追加API     | お知らせの新規追加を行い、その結果を返却するAPI                       |
| 2   | お知らせ履歴情報取得API | 掲載中のお知らせ欄に表示する、今までのお知らせの一覧情報を取得するAPI |
