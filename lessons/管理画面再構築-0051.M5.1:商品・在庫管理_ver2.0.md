# 1. [管理画面再構築](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-%E7%94%BB%E9%9D%A2%E4%B8%80%E8%A6%A7%28ver2.0%29) - M5.1:商品・在庫管理 機能設計書

- [1. 管理画面再構築 - M5.1:商品・在庫管理 機能設計書](#1-管理画面再構築---m51商品在庫管理-機能設計書)
  - [1.1. 処理概要](#11-処理概要)
    - [1.1.1. 機能名](#111-機能名)
    - [1.1.2. 機能概要](#112-機能概要)
    - [1.1.3. 前提条件](#113-前提条件)
    - [1.1.4. 処理概要](#114-処理概要)
    - [1.1.5. パラメータ一覧](#115-パラメータ一覧)
    - [1.1.6. テーブル一覧](#116-テーブル一覧)
    - [1.1.7. ファイル一覧](#117-ファイル一覧)
  - [1.2. レイアウト](#12-レイアウト)
    - [1.2.1. 旧仕様](#121-旧仕様)
    - [1.2.2-1. 画面イメージ（再構築）](#122-1-画面イメージ再構築)
    - [1.2.2-2. 画面イメージ（再構築）(表示順)](#122-2-画面イメージ再構築表示順)
    - [1.2.2-3. 画面イメージ（再構築）(限定商品)](#122-3-画面イメージ再構築限定商品)
    - [1.2.3. 画面項目](#123-画面項目)
    - [1.2.4. イベント定義](#124-イベント定義)
    - [1.3.1 API一覧](#131-api一覧)

## 1.1. 処理概要

### 1.1.1. 機能名
| No. | 項目 | 値 |
|:---:|:----------------:|:-------------------:|
| 1 | プロジェクト | meeth様ECサイト開発 |
| 2 | システム | 管理画面 |
| 3 | 画面プログラム | 商品・在庫管理 |
| 4 | 画面プログラムID | M5.1 |
| 5 | 画面フォーム名 | N/A |

### 1.1.2. 機能概要
- 商品名、公開ステータスで検索する
- 通常商品情報・在庫数を表示する
  - 表示順、商品ID、商品名、価格、公開ステータス、在庫数、注文数、入荷リクエスト数、最終編集日を表示する
  - 初期表示は公開中＋表示順（昇順）
  - 公開中＋表示順（デフォルト昇順）、商品名、在庫数、注文数、リクエスト数でのソートが可能
- キャンペーン商品情報・在庫数を表示する
  - 表示順、商品ID、商品名、価格、公開ステータス、在庫数、注文数、入荷リクエスト数、最終編集日を表示する
  - 公開中＋表示順（デフォルト昇順）、商品名、在庫数、注文数、リクエスト数でのソートが可能
- 商品詳細画面に遷移する
- 商品登録画面に遷移する
- 表示順を変更する
- キャンペーンのタイトルを更新する

### 1.1.3. 前提条件
- ログイン済のユーザであること
- ログインユーザの[権限](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-%E6%A8%A9%E9%99%90%E4%B8%80%E8%A6%A7)が条件を満たしていること(総合管理者、作業担当者のみ閲覧・操作可能)

### 1.1.4. 処理概要
| No | 操作 | 処理概要 |
|----|----------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| 1 | 初期表示時 | 商品情報・在庫数一覧が表示される |
| 2 	| 新規作成ボタンを押下する 	| 商品登録画面に遷移する。 	|
| 3 	| 検索ボタンを押下する 	| 検索処理を実行する。 	|
| 4 	| 商品IDを押下する 	| 商品詳細画面に遷移する。 	|
| 5 	| 1.表示順設定リンクを押下する<br>2. 更新ボタンを押下する 	| 表示順を設定する。 	|
| 6 	| 1. 編集ボタンを押下する<br>2. 更新ボタンを押下する 	| キャンペーンのタイトルを更新する。 	|

### 1.1.5. パラメータ一覧

なし

### 1.1.6. テーブル一覧
| No | 論理名称 | 物理名称 | I/O | 備考 |
|----|------------------|-------------------|-----|------|
| 1 | [商品テーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_products) | products | O | |
| 2 | [商品詳細テーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_product_details) | product_details | O | |
| 3 | [商品価格テーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_product_prices) | product_prices | O | |
| 4 | [商品在庫数](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_product_stocks) |product_stocks | O | |
| 5 | [マスターデータテーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_settings) | settings | I・O | |
| 6 | 入荷リクエストテーブル | restock_requests | O | |
| 7 | [注文テーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_orders) | orders | O | |
| 8 | [注文詳細テーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_order_details) | order_details | O | |



### 1.1.7. ファイル一覧
なし

## 1.2. レイアウト
### 1.2.1. [旧仕様]()


### 1.2.2-1. 画面イメージ（再構築）
![image](https://user-images.githubusercontent.com/77314669/115355007-36009780-a1f5-11eb-808d-5cabb30f40ce.png)


### 1.2.2-2. 画面イメージ（再構築）(表示順)
![image](https://user-images.githubusercontent.com/77314669/115497207-2db46500-a2a6-11eb-9a0f-fdd5faa1e96c.png)



### 1.2.2-3. 画面イメージ（再構築）(限定商品)
![image](https://user-images.githubusercontent.com/77314669/115360490-a1993380-a1fa-11eb-9eef-1681041adef3.png)



### 1.2.3. 画面項目


| No  | 名称                    | 対応DB項目                                                                   | I/O | 種別             | 型                | 桁数 | 必須(YES/NO) | バリデーション                                      | 備考                                                                                                                                                                     |
|-----|-------------------------|------------------------------------------------------------------------------|-----|------------------|-------------------|------|--------------|-----------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1   | 新規作成                | －                                                                           | O   | ボタン           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 2   | 検索：商品名            | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
|     |                         | products.name                                                                | I   | テキストボックス | string            | 255  | NO           | 桁数制限                                            |                                                                                                                                                                          |
| 3   | 検索：公開ステータス    | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
|     |                         | products.status                                                              | I   | プルダウン       | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 4   | 検索ボタン              | －                                                                           | O   | ボタン           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 5   | 件数表示                | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 6   | 表示順設定              | －                                                                           | O   | リンク           | －                | －   | －           | －                                                  |                                                                                                    表示順設定モーダルを表示する                                                                      |
|     |                         | products.display_order                                                       | O   | テキスト         | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 7   | 商品ID                  | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
|     |                         | products.id                                                                  | O   | リンク           | －                | －   | －           | －                                                  | 商品ID押下で商品詳細画面に遷移                                                                                                                                           |
| 8   | 商品名                  | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  | ソートができること                                                                                                                                                       |
|     |                         | products.name                                                                | O   | テキスト         | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 9   | 価格                    | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
|     |                         | products.id<br>product_details.id<br>product_prices.selling_price            | O   | テキスト         | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 10  | 公開ステータス          | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
|     |                         | products.status                                                              | O   | テキスト         | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 11  | 在庫数                  | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  | ソートができること                                                                                                                                                       |
|     |                         | products.id<br>product_details.id<br>product_stocks.stock                    | O   | テキスト         | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 12  | 注文数                  | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  | ソートができること                                                                                                                                                       |
|     |                         | products.id<br>product_details.id<br>order_details.quantity<br>orders.status | O   | テキスト         | －                | －   | －           | －                                                  | orders.statusがキャンセル・返品以外の合計注文数表示                                                                                                                      |
| 13  | 入荷リクエスト数        | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  | ソートができること                                                                                                                                                       |
|     |                         | product_details.id<br>restock_requests.id                                    | O   | テキスト         | －                | －   | －           | －                                                  | 合計数表示                                                                                                                                                               |
| 14  | 最終編集日              | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
|     |                         | products.updated_at                                                          | O   | テキスト         | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 15  | 日本語タイトル名        | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  | settings.categoryがCAMPAIGNのデータ（keyはCAMPAIGN_TITLE）                                                                                                               |
| 16  | 編集                    | －                                                                           | O   | ボタン           | －                | －   | －           | －                                                  | キャンペーンタイトル編集モーダルを表示する る                                                                                                                                                       |
| 17  | 表示順の設定            | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 18  | - 表示順                | products.display_order                                                       | I   | テキストボックス | integer<br>number | －   | －           | －                                                  | ドラッグアンドドロップで表示順を変えられるのが望ましい                                                                                                                   |
| 19  | - 商品ID                | products.id                                                                  | O   | テキスト         | －                | －   | －           | －                                                  |                                                                                                                                                                          |
|     | - 商品名                | products.name                                                                | O   | テキスト         | －                | －   | －           | －                                                  |                                                                                                                                                                          |
| 20  | x ボタン                | －                                                                           | O   | ボタン           | －                | －   | －           | －                                                  | モーダルを閉じる                                                                                                                                                         |
| 21  | タイトル編集            | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  |                                                                                                                                                       |
| 22  | 英語タイトル名          | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  | 登録されている英語タイトル名を表示する                                                                                                                                   |
|     | - 英語タイトル          | settings.category<br>settings.key                                            | I   | フォーム         | －                | －   | －           | －                                                  | settings.categoryがCAMPAIGNのデータ（keyはCAMPAIGN_TITLE）                                                                                                               |
| 23  | 日本語タイトル名        | －                                                                           | O   | ラベル           | －                | －   | －           | －                                                  | 登録されている日本語タイトル名を表示する                                                                                                                                 |
|     | - 日本語タイトル        | settings.category<br>settings.key                                            | I   | フォーム         | －                | －   | －           | －                                                  | settings.categoryがCAMPAIGNのデータ（keyはCAMPAIGN_TITLE_JAPANESE）                                                                                                      |
| 24  | 更新                    | －                                                                           | O   | ボタン           | －                | －   | －           | －                                                  | タイトルを更新する                                                                                                                                                       |
| 25  | x ボタン                | －                                                                           | O   | ボタン           | －                | －   | －           | －                                                  | モーダルを閉じる                                                                                                                                                         |
| 26  | 更新ボタン                | －                                                                           | O   | ボタン           | －                | －   | －           | －                                                  | 表示順を更新する                                                                                                                                                         |

### 1.2.4. イベント定義

| No  | 項目           | 発生条件 | 遷移先 | 備考 | API |
| --- | -------------- | -------- | ------ | ---- | - |
| 1   | 初期表示<br>検索ボタン      | クリック |    ー    |      | 詳細情報取得API |
| 2   | 新規登録ボタン       | クリック |    [商品登録画面](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-0052.M5.2:%E5%95%86%E5%93%81%E7%99%BB%E9%8C%B2_ver2.0)    |     | - |
| 3   | 商品ID       | クリック |    [商品詳細画面](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-0053.M5.3:%E5%95%86%E5%93%81%E8%A9%B3%E7%B4%B0_ver2.0)    |     | - |
| 4   | 表示順設定リンク | クリック |    表示順設定モーダル    |      |  |
| 4   | (表示順設定)更新ボタン | クリック |    表示順設定モーダル    |      |表示順更新API  |
| 5   | (キャンペーン)編集ボタン       | クリック |    キャンペーンタイトル編集モーダル    |     | キャンペーンタイトル更新API |

### 1.3.1 API一覧
| NO. | 名称 | 内容 |
|-|-|-|
| 1   | 詳細情報取得API| 詳細情報を取得する |
| 2   | 表示順更新API| 表示順を取得する |
| 3   | キャンペーン名称更新API | キャンペーンタイトル名称を更新する                     |
