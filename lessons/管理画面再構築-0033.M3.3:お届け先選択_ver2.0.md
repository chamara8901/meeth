# 1. [管理画面再構築](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-%E7%94%BB%E9%9D%A2%E4%B8%80%E8%A6%A7%28ver2.0%29) - M3.3:注文管理.お届け先選択 機能設計書

## 1.1. 処理概要

### 1.1.1. 機能名
| No. | 項目 | 値 |
|:---:|:----------------:|:-------------------:|
| 1 | プロジェクト | meeth様ECサイト開発 |
| 2 | システム | 管理画面 |
| 3 | 画面プログラム | お届け先選択 |
| 4 | 画面プログラムID | M3.3 |
| 5 | 画面フォーム名 | N/A |

### 1.1.2. 機能概要

- お届け先情報を変更する

### 1.1.3. 前提条件

- ログイン済のユーザであること
- ログインユーザの[権限](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-%E6%A8%A9%E9%99%90%E4%B8%80%E8%A6%A7)が条件を満たしていること(総合管理者、許可された作業担当者のみ閲覧・操作可能)

### 1.1.4. 処理概要
| No | 操作 | 処理概要 |
|----|----------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| 1 | 初期表示時 | 注文詳細が表示される |
| 2 | 変更ボタンを押下する | 当該注文のお届け先住所を選択するモーダルが表示される |
| 3 | お届け先住所選択モーダル表示時 | 登録済のお届け先住所がラジオボタンと併せて表示される |
| 4 | お届け先変更の確定ボタンを押下する | 当該注文のお届け先住所を更新する |

### 1.1.5. パラメータ一覧

| No | 論理名称 | 物理名称 | I/O | 備考 |
|----------------|----------|-----------|-----|------|
| 1 | 注文ID | order_id | O | |

### 1.1.6. テーブル一覧
| No | 論理名称 | 物理名称 | I/O | 備考 |
|----|------------------|-------------------|-----|------|
| 1 | [顧客情報テーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_customers) | customer | O | |
| 2 | [顧客住所テーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_customer_addresses) | customer_addresses | O | |
| 3 | [注文テーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_orders) | orders | O | |

### 1.1.7. ファイル一覧

なし

## 1.2. レイアウト
### 1.2.1. 画面イメージ（現行）
![image](https://user-images.githubusercontent.com/77314669/112423445-fcfc1100-8d75-11eb-99b3-b3b3f8fd169f.png)


### 1.2.2. 画面イメージ（再構築）

![image](https://user-images.githubusercontent.com/77314669/113750095-533d5c80-9745-11eb-98b8-9e428027ad9e.png)
&dArr;
![image](https://user-images.githubusercontent.com/77314669/114663205-e6bdf100-9d34-11eb-98f5-de10d35d0d43.png)


### 1.2.3. 画面項目

| No    | 名称                    | 対応DB項目                                                                                | I/O   | 種別       | 型     | 桁数   | 必須   | 備考                                                                                                   |
|-------|-------------------------|-------------------------------------------------------------------------------------------|-------|------------|--------|--------|--------|--------------------------------------------------------------------------------------------------------|
| 1     | 変更                    | －                                                                                        | O     | ボタン     | －     | －     | －     | お届け先住所選択モーダルを表示する<br>現在選択中の住所がデフォルトで選択されている状態とする           |
| 2     | お届け先住所を選択      | －                                                                                        | O     | ラベル     | －     | －     | －     |                                                                                                        |
| 3     |                         | customer_addresses.family_name                                                            | O     | テキスト   | －     | －     | －     |                                                                                                        |
| 4     |                         | customer_addresses.first_name                                                             | O     | テキスト   | －     | －     | －     |                                                                                                        |
|       | 様                      | －                                                                                        | O     | ラベル     | －     | －     | －     |                                                                                                        |
| 5     | 住所：                  | －                                                                                        | O     | ラベル     | －     | －     | －     |                                                                                                        |
|       |                         | customer_addresses.zip_code                                                               |       |            |        |        |        |                                                                                                        |
| 6     |                         | customer_addresses.prefecture                                                             |       |            |        |        |        |                                                                                                        |
|       |                         | customer_addresses.address1                                                               |       |            |        |        |        |                                                                                                        |
|       |                         | customer_addresses.address2                                                               |       |            |        |        |        |                                                                                                        |
|       |                         | customer_addresses.address3                                                               |       |            |        |        |        |                                                                                                        |
| 7     | 電話番号：              | －                                                                                        | O     | ラベル     | －     | －     | －     |                                                                                                        |
|       |                         | customer_addresses.phone                                                                  | O     | テキスト   | －     | －     | －     |                                                                                                        |
| 8     | お届け先変更の確定      | －                                                                                        | O     | ボタン     | －     | －     | －     |                                                                                                        |
| 9     | xボタン                 | －                                                                                        | O     | ボタン     | －     | －     | －     | お届け先住所選択モーダルを閉じる                                                                       |

### 1.2.4. イベント定義

| No  | 項目           | 発生条件 | 遷移先 | 備考 | API |
| --- | -------------- | -------- | ------ | ---- | -- |
| 1   | 変更ボタン       | クリック |    お届け先住所選択モーダル    |      |     |
| 2   | お届け先変更の確定ボタン       | クリック |    [注文詳細画面](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-0032.M3.2:%E6%B3%A8%E6%96%87%E8%A9%B3%E7%B4%B0_ver2.0)    | お届け先を確定し注文詳細画面を再描画する     | お届け先住所変更API    |

## 1.3. API

### 1.3.1. API一覧
| NO. | 名称 | 内容 |
|-|-|-|
| 1 | お届け先住所変更API | 当該注文に対するお届け先住所を変更する |

