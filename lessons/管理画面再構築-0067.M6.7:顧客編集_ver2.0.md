# 1. [管理画面再構築](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-%E7%94%BB%E9%9D%A2%E4%B8%80%E8%A6%A7%28ver2.0%29) - M6.7:顧客詳細.編集 機能設計書

- [1. 管理画面再構築 - M6.7:顧客詳細.編集 機能設計書](#1-管理画面再構築---m67顧客詳細編集-機能設計書)
  - [1.1. 処理概要](#11-処理概要)
    - [1.1.1. 機能名](#111-機能名)
    - [1.1.2. 機能概要](#112-機能概要)
    - [1.1.3. 前提条件](#113-前提条件)
    - [1.1.4. 処理概要](#114-処理概要)
    - [1.1.5. パラメータ一覧](#115-パラメータ一覧)
    - [1.1.6. テーブル一覧](#116-テーブル一覧)
    - [1.1.7. ファイル一覧](#117-ファイル一覧)
  - [1.2. レイアウト](#12-レイアウト)
    - [1.2.1. 画面イメージ（現行）](#121-画面イメージ現行)
    - [1.2.2. 画面イメージ（再構築）](#122-画面イメージ再構築)
    - [1.2.3. 画面項目](#123-画面項目)
    - [1.2.4. イベント定義](#124-イベント定義)
  - [1.3. API](#13-api)
    - [1.3.1. API一覧](#131-api一覧)

## 1.1. 処理概要

### 1.1.1. 機能名

|  No.  |       項目       |         値          |
| :---: | :--------------: | :-----------------: |
|   1   |   プロジェクト   | meeth様ECサイト開発 |
|   2   |     システム     |      管理画面       |
|   3   |  画面プログラム  |      顧客詳細       |
|   4   | 画面プログラムID |        M6.7         |
|   5   |  画面フォーム名  |         N/A         |

### 1.1.2. 機能概要

- 顧客情報の編集を行う


### 1.1.3. 前提条件
- ログイン済のユーザであること
- ログインユーザの[権限](https://github.com/grrowjp/Meeth/wiki/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E5%86%8D%E6%A7%8B%E7%AF%89-%E6%A8%A9%E9%99%90%E4%B8%80%E8%A6%A7)が条件を満たしていること(総合管理者、許可された作業担当者のみ閲覧・操作可能)

### 1.1.4. 処理概要
| No  | 操作                                               | 処理概要                                             |
| --- | -------------------------------------------------- | ---------------------------------------------------- |
| 1   | 初期表示時                                         | 顧客検索画面にて選択された顧客の詳細情報を表示する。 |
| 2   | 編集ボタン押下時                                 | 編集可能な項目についてフォームを表示する。                                 |
| 3   | 確認ボタン押下時 | 変更項目をハイライトで表示する。                         |
| 4   | 完了ボタン押下時   | 編集内容を確定し顧客詳細画面を再描画する。                             |

### 1.1.5. パラメータ一覧

| No  | 論理名称 | 物理名称 | I/O | 備考 |
| --- | -------- | -------- | --- | ---- |
| 1 | 顧客ID | customer_id | O | |

### 1.1.6. テーブル一覧
| No  | 論理名称                                                                                                                                      | 物理名称              | I/O | 備考 |
| --- | --------------------------------------------------------------------------------------------------------------------------------------------- | --------------------- | --- | ---- |
| 1   | [顧客情報テーブル](https://github.com/grrowjp/Meeth/wiki/%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%AE%9A%E7%BE%A9_customers)                    | customers             | O   |      |

### 1.1.7. ファイル一覧

なし

## 1.2. レイアウト
### 1.2.1. 画面イメージ（現行）
![image](https://user-images.githubusercontent.com/77314669/112284500-aa1a4f00-8ccc-11eb-8854-2aaf2cc37ca9.png)

### 1.2.2. 画面イメージ（再構築）
![image](https://user-images.githubusercontent.com/77314669/115187494-6590a080-a11e-11eb-9611-78fdd3be8563.png)


&dArr;
![image](https://user-images.githubusercontent.com/77314669/116215103-5646ce00-a782-11eb-90c8-570c724204e6.png)



&dArr;
![image](https://user-images.githubusercontent.com/77314669/116215213-6e1e5200-a782-11eb-8d95-f32296bcec5c.png)





&dArr;
![image](https://user-images.githubusercontent.com/77314669/116215296-82624f00-a782-11eb-8ff5-bd7b4c0ec91d.png)



&dArr;
![image](https://user-images.githubusercontent.com/77314669/116178133-f9322480-a74f-11eb-968a-bd3c2e0a88c1.png)




### 1.2.3. 画面項目

| No  | 名称                     | 対応DB項目            | I/O | 種別     | 型                | 桁数 | 必須 | バリデーション | 備考                             |
|-----|--------------------------|-----------------------|-----|----------|-------------------|------|------|----------------|----------------------------------|
| 1   | 編集                     | ー                    | O   | ボタン   | ー                | ー   | ー   | ー             |                                  |
| 2   | 確認                     | ー                    | O   | ボタン   | ー                | ー   | ー   | ー             |                                 |
| 3   | メールアドレス | customers.email       | O   | フォーム | string            | 255  | YES  | 空白不可       |                                  |
| 4   | DM拒否      | customers.dm_agreed   | O   | フォーム | integer<br>number | 1    | YES  | 空白不可       |                                  |
| 5   | 名前          | customers.family_name | O   | フォーム | string            | 255  | YES  | 空白不可       |                                  |
|     |                          | customers.first_name  | O   | フォーム | string            | 255  | YES  | 空白不可       |                                  |
| 6   | 誕生日         | customers.birthday    | O   | フォーム | string            | ー   | YES  | 空白不可       | カレンダーアイコンでのみ設定可能 |
| 7   | 完了                     | ー                    | O   | ボタン   | ー                | ー   | ー   | ー             |                                  |
| 8   | キャンセル                     | ー                    | O   | ボタン   | ー                | ー   | ー   | ー             |                                  |
| 9   | 戻る                     | ー                    | O   | ボタン   | ー                | ー   | ー   | ー             |                                  |

### 1.2.4. イベント定義

| No  | 項目           | 発生条件 | 遷移先 | 備考 | API |
| --- | -------------- | -------- | ------ | ---- | -- |
| 1   | 編集       | クリック |    編集フォーム画面    |    | (顧客詳細情報取得API) |
| 2   | 確認       | クリック |    確認画面    | 1. 押下時にバリデーションを実施<br>2. 問題なければ変更内容をハイライト表示した確認画面を表示する、エラー時はエラー内容を表示の上編集フォーム画面を再描画する   | 顧客編集API |
| 3   | 完了 | クリック |    顧客詳細画面    |     | 顧客編集API |

## 1.3. API

### 1.3.1. API一覧
| NO. | 名称        | 内容                    |
| --- | ----------- | ----------------------- |
| 1   | 顧客編集API | 顧客情報の編集を行うAPI |